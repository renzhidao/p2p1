
<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>P2P èŠ‚ç‚¹ï¼ˆå›ºå®šå…¥å£ Â· æ›´å¿«ä¼ è¾“ Â· é¢„è§ˆ Â· è¯¦ç»†æ—¥å¿—ï¼‰</title>
  <style>
    *{margin:0;padding:0;box-sizing:border-box}
    body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',sans-serif;background:#fafafa;color:#333;padding:16px}
    .wrap{max-width:800px;margin:0 auto;background:#fff;border:1px solid #eee;border-radius:12px;box-shadow:0 4px 24px rgba(0,0,0,.06);padding:16px}
    h1{font-size:20px;margin-bottom:8px}
    .status{display:inline-block;padding:6px 10px;border-radius:20px;font-size:12px;margin:6px 0}
    .offline{background:#fee;color:#b30000}
    .online{background:#eefbe7;color:#1b7a00}
    .connecting{background:#fff5cc;color:#996800}
    .row{display:flex;gap:8px;margin:10px 0;align-items:center}
    .row button{padding:10px 14px;border:0;border-radius:8px;background:#4f6ef7;color:#fff;font-weight:600}
    .info{background:#f7f7f7;border:1px solid #eee;border-radius:8px;padding:10px;margin-top:6px;font-size:14px}
    .info div{display:flex;justify-content:space-between;margin:6px 0}
    .share{display:none;margin-top:10px;border:1px dashed #f0b400;background:#fff9e6;border-radius:8px;padding:10px}
    #qr{width:150px;height:150px;margin-top:10px;background:#fff;border:1px solid #eee;border-radius:6px;display:flex;align-items:center;justify-content:center}
    #qr img{max-width:100%;max-height:100%}
    .tools{display:none;margin-top:10px;border:1px solid #e6e6e6;border-radius:8px;padding:10px}
    .tool-row{display:flex;gap:8px;align-items:center;margin:6px 0}
    .tool-row input[type="file"]{flex:1}
    .chat{display:none;margin-top:10px;border:1px solid #e6e6e6;border-radius:8px;overflow:hidden}
    .chat-msgs{min-height:200px;max-height:320px;overflow:auto;padding:10px;background:#fafafa}
    .msg{margin-bottom:8px;padding:6px 8px;border-radius:6px;font-size:14px;max-width:86%}
    .me{background:#eaf2ff;margin-left:auto}
    .peer{background:#fff;border:1px solid #eee}
    .msg small{display:block;font-size:11px;color:#999;margin-bottom:2px}
    .chat-input{display:flex;border-top:1px solid #eee}
    .chat-input input{flex:1;border:0;padding:10px}
    .chat-input button{border:0;background:#4f6ef7;color:#fff;padding:10px 14px}
    .media-bubble{background:#fff;border:1px solid #eee;border-radius:8px;padding:6px}
    .media-thumb{width:200px;max-width:80vw;border-radius:6px;display:block}
    .media-video{width:260px;max-width:90vw;border-radius:6px;display:block;background:#000}
    .progress-line{font-size:12px;color:#666;margin-top:4px}
    .logbox{margin-top:10px}
    .log-actions{display:flex;gap:8px;margin-bottom:6px;flex-wrap:wrap}
    .log-actions button{padding:8px 10px;border:1px solid #ddd;background:#fff;border-radius:8px}
    pre{background:#111;color:#0f0;border-radius:8px;padding:10px;height:240px;overflow:auto;margin:0;font-family:monospace;font-size:12px;white-space:pre-wrap}
    .muted{color:#888;font-size:12px}
  </style>
</head>
<body>
  <div class="wrap">
    <h1>ğŸš€ P2P èŠ‚ç‚¹ï¼ˆå›ºå®šå…¥å£ï¼‰</h1>
    <span id="status" class="status offline">â— ç¦»çº¿</span>

    <div class="row">
      <button id="connectBtn" onclick="app.toggle()">ğŸ”Œ è¿æ¥ç½‘ç»œ</button>
      <button onclick="window.open('classic.html','_blank')">æ‰“å¼€â€œèŠå¤©é£æ ¼ UIâ€ï¼ˆæ–°é¡µï¼‰</button>
      <span class="muted">å…¥å£å›ºå®šä¸ºæœ¬é¡µï¼Œæ— éœ€ä»»ä½•å‚æ•°</span>
    </div>

    <div class="info">
      <div><span>æœ¬åœ° ID</span><b id="localId">-</b></div>
      <div><span>è™šæ‹Ÿ IP</span><b id="virtualIp">-</b></div>
      <div><span>åœ¨çº¿èŠ‚ç‚¹</span><b id="peerCount">0</b></div>
      <div><span>è¿è¡Œæ—¶é•¿</span><b id="uptime">00:00:00</b></div>
    </div>

    <div id="share" class="share">
      <div style="display:flex;gap:8px;align-items:center">
        <input id="shareLink" readonly style="flex:1">
        <button onclick="app.copyLink()">å¤åˆ¶é‚€è¯·é“¾æ¥</button>
      </div>
      <div id="qr"></div>
      <div class="muted" style="margin-top:6px;">
        ä½¿ç”¨æ–¹æ³•ï¼šA å…ˆç‚¹â€œè¿æ¥ç½‘ç»œâ€ï¼Œå¤åˆ¶æ­¤é“¾æ¥/æ‰«ç ç»™ Bï¼›B æ‰“å¼€åä¹Ÿç‚¹â€œè¿æ¥ç½‘ç»œâ€ã€‚é“¾æ¥ä»…åŒ…å« peer å‚æ•°ï¼Œå·²å›ºå®šåŒæœã€‚
      </div>
    </div>

    <div id="tools" class="tools">
      <div class="tool-row">
        <input id="fileInput" type="file" multiple>
        <button onclick="app.sendFiles()">å‘é€æ–‡ä»¶ï¼ˆæ›´å¿«ï¼‰</button>
      </div>
    </div>

    <div id="chat" class="chat">
      <div id="msgs" class="chat-msgs"></div>
      <div class="chat-input">
        <input id="msgInput" placeholder="è¾“å…¥æ¶ˆæ¯å›è½¦æˆ–ç‚¹å‘é€" onkeypress="if(event.keyCode===13)app.sendMsg()">
        <button onclick="app.sendMsg()">å‘é€</button>
      </div>
    </div>

    <div class="logbox">
      <div class="log-actions">
        <button onclick="app.copyLog()">å¤åˆ¶æ—¥å¿—</button>
        <button onclick="app.clearLog()">æ¸…ç©ºæ—¥å¿—</button>
      </div>
      <pre id="log">> åˆå§‹åŒ–ä¸­...</pre>
    </div>

    <div style="margin-top:8px" class="muted">
      å¦‚é‡â€œæœåŠ¡å™¨æ‰çº¿é¢‘ç¹â€ï¼šä¼˜å…ˆæ¢ç½‘ç»œ/çƒ­ç‚¹ï¼›æˆ–åœ¨ VPN å®¢æˆ·ç«¯æ”¾è¡Œâ€œæœ¬åœ°ç½‘ç»œ/UDP/P2Pâ€ã€‚ä¸æƒ³æŠ˜è…¾å°±åˆ«å¼€ VPNã€‚
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/peerjs@1.5.0/dist/peerjs.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/davidshimjs-qrcodejs@0.0.2/qrcode.min.js"></script>
  <script src="easytier.js"></script>
  <script>
    // è‡ªåŠ¨è¿æ¥ï¼ˆå›ºå®šç½‘ç»œå/å›ºå®šæœåŠ¡å™¨ï¼‰
    document.addEventListener('DOMContentLoaded', function(){
      if (window.app && !app.isConnected) {
        app.toggle(); // è‡ªåŠ¨è¿
      }
    });
  </script>
</body>
</html>